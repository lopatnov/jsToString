{"version":3,"file":"javascripttostring.es5.js","sources":["../src/javascripttostring.ts"],"sourcesContent":["import getObjectType from \"@lopatnov/get-internal-type\";\r\n\r\nexport interface IJ2SOptions {\r\n  includeFunctionProperties?: boolean; // default true\r\n  includeFunctionPrototype?: boolean; // default true\r\n  includeBuffers?: boolean; // default true\r\n  nestedObjectsAmount?: number; // default Number.POSITIVE_INFINITY\r\n  nestedArraysAmount?: number; // default Number.POSITIVE_INFINITY\r\n  nestedFunctionsAmount?: number; // default Number.POSITIVE_INFINITY\r\n}\r\n\r\ninterface RefInstance {\r\n  historyRef: Array<any>,\r\n  source: any\r\n}\r\n\r\nvar refs: RefInstance[] = [];\r\nvar counter = 0;\r\n\r\ninterface IJ2SHistory {\r\n  references: any[];\r\n  nestedObjectsLeft: number;\r\n  nestedArraysLeft: number;\r\n  nestedFunctionsLeft: number;\r\n}\r\n\r\nfunction numberToString(value: number): string {\r\n  if (Number.isNaN(value)) {\r\n    return \"Number.NaN\";\r\n  }\r\n  switch (value) {\r\n    case Number.POSITIVE_INFINITY:\r\n      return \"Number.POSITIVE_INFINITY\";\r\n    case Number.NEGATIVE_INFINITY:\r\n      return \"Number.NEGATIVE_INFINITY\";\r\n    case Number.EPSILON:\r\n      return \"Number.EPSILON\";\r\n    case Number.MAX_SAFE_INTEGER:\r\n      return \"Number.MAX_SAFE_INTEGER\";\r\n    case Number.MIN_SAFE_INTEGER:\r\n      return \"Number.MIN_SAFE_INTEGER\";\r\n    case Number.MAX_VALUE:\r\n      return \"Number.MAX_VALUE\";\r\n    case Number.MIN_VALUE:\r\n      return \"Number.MIN_VALUE\";\r\n    case Math.PI:\r\n      return \"Math.PI\";\r\n    case Math.E:\r\n      return \"Math.E\";\r\n    case Math.LN10:\r\n      return \"Math.LN10\";\r\n    case Math.LN2:\r\n      return \"Math.LN2\";\r\n    case Math.LOG10E:\r\n      return \"Math.LOG10E\";\r\n    case Math.LOG2E:\r\n      return \"Math.LOG2E\";\r\n    case Math.SQRT1_2:\r\n      return \"Math.SQRT1_2\";\r\n    case Math.SQRT2:\r\n      return \"Math.SQRT2\";\r\n    default:\r\n      return String(value);\r\n  }\r\n}\r\n\r\nfunction symbolToString(value: any): string {\r\n  switch (value) {\r\n    case Symbol.asyncIterator:\r\n    case Symbol.hasInstance:\r\n    case Symbol.isConcatSpreadable:\r\n    case Symbol.iterator:\r\n    case Symbol.match:\r\n    case Symbol.prototype:\r\n    case Symbol.replace:\r\n    case Symbol.search:\r\n    case Symbol.species:\r\n    case Symbol.split:\r\n    case Symbol.toPrimitive:\r\n    case Symbol.toStringTag:\r\n    case Symbol.unscopables:\r\n      return value.description;\r\n    default:\r\n      let description = value.description ? `\"${value.description}\"` : \"\";\r\n      return `Symbol(${description})`;\r\n  }\r\n}\r\n\r\nfunction dateToString(value: Date): string {\r\n  if (isNaN(value.getTime())) {\r\n    return `new Date(${value.toString()})`;\r\n  }\r\n  return `new Date(${value.toISOString()})`;\r\n}\r\n\r\nfunction errorToString(value: any): string {\r\n  let message = JSON.stringify(value.message),\r\n    fileName = JSON.stringify(value.fileName),\r\n    lineNumber = JSON.stringify(value.lineNumber);\r\n  return `new Error(${message}, ${fileName}, ${lineNumber})`;\r\n}\r\n\r\nfunction arrayToString(\r\n  value: Array<any>,\r\n  options: IJ2SOptions,\r\n  history: IJ2SHistory\r\n): string {\r\n  if (value.length === 0) return \"[]\";\r\n  let arrayValues = value.reduce(\r\n    (x1: any, x2: any, index: number) => {\r\n      history.references.push(index.toString());\r\n      let str = !!x1 ? `${x1}, ` : '';\r\n      str += stringifyRef(x2,options,history);\r\n      history.references.pop();\r\n      return str;\r\n    }, '');\r\n  return attachActions(getLocalRefs(value), `[${arrayValues}]`);\r\n}\r\n\r\nfunction getLocalRefs(value: any) {\r\n  return refs.filter(x => x.source === value)\r\n}\r\n\r\nfunction attachActions(localRefs: RefInstance[], result: string) {\r\n  if (localRefs.length > 0) {\r\n    counter = (counter++) % Number.MAX_SAFE_INTEGER;\r\n    const localName = `___j2s_${counter}`;\r\n    const actions = localRefs.reduce((x1: string, x2: RefInstance) => {\r\n      const action = converToAction(localName, x2);\r\n      refs.splice(refs.indexOf(x2), 1);\r\n      return x1 + action;\r\n    }, '');\r\n    return `(function(){ var ${localName} = ${result}; ${actions} return ${localName}; }())`;\r\n  }\r\n  return result;\r\n}\r\n\r\nfunction converToAction(localName: string, r: RefInstance) {\r\n  const destIndex = r.historyRef.indexOf(r.source);\r\n  if (destIndex < 0) {\r\n    return '';\r\n  }\r\n\r\n  const dest = r.historyRef.slice(destIndex);\r\n  let sourceObj: any;\r\n  let path = '';\r\n  for (let i = 0; i < dest.length; i++) {\r\n    const destObj = dest[i];\r\n    if (destObj === r.source) {\r\n      path = localName;\r\n      sourceObj = r.source;\r\n    } else if (typeof destObj === 'string') {\r\n      path += `['${destObj.replace(/'/gi, '\\\\\\'')}']`;\r\n      sourceObj = sourceObj[destObj];\r\n    } else if (destObj !== sourceObj) {\r\n      return '';\r\n    }\r\n  }\r\n\r\n  return `${path} = ${localName}; `;\r\n}\r\n\r\nfunction typedArrayToString(\r\n  value: any,\r\n  options: IJ2SOptions,\r\n  history: IJ2SHistory\r\n): string {\r\n  let arr = Array.from(value),\r\n    arrString = arrayToString(arr, options, history),\r\n    constructorName = value.constructor.name;\r\n  return `new ${constructorName}(${arrString})`;\r\n}\r\n\r\nfunction setToString(\r\n  value: Set<any>,\r\n  options: IJ2SOptions,\r\n  history: IJ2SHistory\r\n): string {\r\n  let setValues: string[] = [];\r\n\r\n  value.forEach((value1: any, value2: any, set: Set<any>) => {\r\n    setValues.push(stringifyRef(value2, options, history));\r\n  });\r\n\r\n  if (setValues.length === 0) return \"new Set()\";\r\n\r\n  return `new Set([${setValues.join(\", \")}])`;\r\n}\r\n\r\nfunction mapToString(\r\n  value: Map<any, any>,\r\n  options: IJ2SOptions,\r\n  history: IJ2SHistory\r\n): string {\r\n  let mapValues: string[] = [];\r\n\r\n  value.forEach((indexValue: any, key: any) => {\r\n    mapValues.push(\r\n      `[${stringifyRef(key, options, history)}, ${stringifyRef(\r\n        indexValue,\r\n        options,\r\n        history\r\n      )}]`\r\n    );\r\n  });\r\n\r\n  if (mapValues.length === 0) return \"new Map()\";\r\n\r\n  return `new Map([${mapValues.join(\", \")}])`;\r\n}\r\n\r\nfunction objectToString(\r\n  value: any,\r\n  options: IJ2SOptions,\r\n  history: IJ2SHistory\r\n): string {\r\n  let objectValues = [];\r\n\r\n  for (let propertyName in value) {\r\n    if (value.hasOwnProperty(propertyName)) {\r\n      history.references.push(propertyName);\r\n      let propertyValue = stringifyRef(value[propertyName], options, history);\r\n      history.references.pop();\r\n      if (propertyValue !== \"undefined\") {\r\n        objectValues.push(`${propertyName}: ${propertyValue}`);\r\n      }\r\n    }\r\n  }\r\n\r\n  if (objectValues.length === 0) return \"{}\";\r\n\r\n  return attachActions(getLocalRefs(value), `{\\n${objectValues.join(\",\\n\")}\\n}`);\r\n}\r\n\r\nfunction functionPropertiesToString(\r\n  functionName: string,\r\n  value: any,\r\n  options: IJ2SOptions,\r\n  history: IJ2SHistory\r\n): string {\r\n  let result = \"\";\r\n  for (let propertyName in value) {\r\n    if (value.hasOwnProperty(propertyName)) {\r\n      history.references.push(propertyName);\r\n      let propertyValue = stringifyRef(value[propertyName], options, history);\r\n      history.references.pop();\r\n      if (propertyValue !== \"undefined\") {\r\n        result += `${functionName}.${propertyName} = ${propertyValue};\\n`;\r\n      }\r\n    }\r\n  }\r\n  return result;\r\n}\r\n\r\nfunction functionToString(\r\n  value: any,\r\n  options: IJ2SOptions,\r\n  history: IJ2SHistory\r\n): string {\r\n  let functionName = value.name || \"anonymousFunction\";\r\n  let functionObject = options.includeFunctionProperties\r\n    ? functionPropertiesToString(functionName, value, options, history)\r\n    : \"\";\r\n  history.references.push('prototype');\r\n  let functionPrototype = options.includeFunctionPrototype\r\n    ? functionPropertiesToString(\r\n        `${functionName}.prototype`,\r\n        value.prototype,\r\n        options,\r\n        history\r\n      )\r\n    : \"\";\r\n  history.references.pop();\r\n\r\n  if (!functionObject && !functionPrototype) {\r\n    return String(value);\r\n  }\r\n\r\n  return attachActions(getLocalRefs(value), `(function(){\\n var ${functionName} = ${String(\r\n    value\r\n  )};\\n ${functionObject}\\n ${functionPrototype}\\n return ${functionName};\\n}())`);\r\n}\r\n\r\nfunction arrayBufferToString(\r\n  value: ArrayBuffer,\r\n  options: IJ2SOptions,\r\n  history: IJ2SHistory\r\n): string {\r\n  if (!options.includeBuffers) return \"undefined\";\r\n  let str = typedArrayToString(new Int8Array(value), options, history);\r\n  return `(${str}).buffer`;\r\n}\r\n\r\nfunction dataViewToString(\r\n  value: DataView,\r\n  options: IJ2SOptions,\r\n  history: IJ2SHistory\r\n): string {\r\n  if (!options.includeBuffers) return \"undefined\";\r\n  let bufString = arrayBufferToString(value.buffer, options, history);\r\n  return `new DataView(${bufString}, ${value.byteOffset}, ${value.byteLength})`;\r\n}\r\n\r\n/**\r\n * Converts to string the value, if it wasn't before\r\n * @param value the value, that converts to string\r\n * @param references the references to stringified objects\r\n */\r\nfunction stringify(\r\n  value: any,\r\n  options: IJ2SOptions,\r\n  history: IJ2SHistory\r\n): string {\r\n  switch (getObjectType(value)) {\r\n    case \"undefined\":\r\n      return \"undefined\";\r\n    case \"null\":\r\n      return \"null\";\r\n    case \"boolean\":\r\n      return String(value);\r\n    case \"regexp\":\r\n      return String(value);\r\n    case \"string\":\r\n      return JSON.stringify(value);\r\n    case \"number\":\r\n      return numberToString(value);\r\n    case \"bigint\":\r\n      return `BigInt(${value})`;\r\n    case \"symbol\":\r\n      return symbolToString(value);\r\n    case \"date\":\r\n      return dateToString(value);\r\n    case \"error\":\r\n      return errorToString(value);\r\n    case \"array\":\r\n      return arrayToString(value, options, history);\r\n    case \"typedarray\":\r\n      return typedArrayToString(value, options, history);\r\n    case \"set\":\r\n      return setToString(value, options, history);\r\n    case \"map\":\r\n      return mapToString(value, options, history);\r\n    case \"object\":\r\n      return objectToString(value, options, history);\r\n    case \"function\":\r\n    case \"generatorfunction\":\r\n      return functionToString(value, options, history);\r\n    case \"arraybuffer\":\r\n      return arrayBufferToString(value, options, history);\r\n    case \"dataview\":\r\n      return dataViewToString(value, options, history);\r\n    case \"promise\":\r\n    case \"generator\":\r\n      return \"undefined\";\r\n    default:\r\n      return JSON.stringify(value);\r\n  }\r\n}\r\n\r\n/**\r\n * Stringify the value, if it wasn't before\r\n * @param value the value, that converts to string\r\n * @param references the references to stringified objects\r\n */\r\nfunction stringifyRef(\r\n  value: any,\r\n  options: IJ2SOptions,\r\n  history: IJ2SHistory\r\n): string {\r\n  const index = history.references.indexOf(value);\r\n  if (index < 0 || typeof(history.references[index]) === 'string') {\r\n    let objectType = getObjectType(value);\r\n    let referencesLength = history.references.length;\r\n    history.references.push(value);\r\n    switch (objectType) {\r\n      case \"object\":\r\n        if (history.nestedObjectsLeft <= 0) return \"undefined\";\r\n        history.nestedObjectsLeft--;\r\n        break;\r\n      case \"array\":\r\n      case \"typedarray\":\r\n        if (history.nestedArraysLeft <= 0) return \"undefined\";\r\n        history.nestedArraysLeft--;\r\n        break;\r\n      case \"function\":\r\n      case \"generatorfunction\":\r\n        if (history.nestedFunctionsLeft <= 0) return \"undefined\";\r\n        history.nestedFunctionsLeft--;\r\n        break;\r\n    }\r\n\r\n    let refString = stringify(value, options, history);\r\n\r\n    history.references.splice(referencesLength);\r\n    switch (objectType) {\r\n      case \"object\":\r\n        history.nestedObjectsLeft++;\r\n        break;\r\n      case \"array\":\r\n      case \"typedarray\":\r\n        history.nestedArraysLeft++;\r\n        break;\r\n      case \"function\":\r\n      case \"generatorfunction\":\r\n        history.nestedFunctionsLeft++;\r\n        break;\r\n    }\r\n\r\n    return refString;\r\n  } else {\r\n    refs.push({\r\n      historyRef: history.references.slice(0),\r\n      source: value\r\n    })\r\n  }\r\n  return \"null\";\r\n}\r\n\r\n/**\r\n * Converts JavaScript value to string\r\n * @param value the value of any type\r\n * @param options [optional] The options of conversion\r\n */\r\nfunction javaScriptToString(value: any, options?: IJ2SOptions): string {\r\n  options = options || {};\r\n  let concreteOptions: IJ2SOptions = {\r\n    includeFunctionProperties:\r\n      options.includeFunctionProperties === undefined\r\n        ? true\r\n        : options.includeFunctionProperties,\r\n    includeFunctionPrototype:\r\n      options.includeFunctionPrototype === undefined\r\n        ? true\r\n        : options.includeFunctionPrototype,\r\n    includeBuffers:\r\n      options.includeBuffers === undefined ? true : options.includeBuffers,\r\n    nestedObjectsAmount:\r\n      options.nestedObjectsAmount === undefined\r\n        ? Number.POSITIVE_INFINITY\r\n        : options.nestedObjectsAmount,\r\n    nestedArraysAmount:\r\n      options.nestedArraysAmount === undefined\r\n        ? Number.POSITIVE_INFINITY\r\n        : options.nestedArraysAmount,\r\n    nestedFunctionsAmount:\r\n      options.nestedFunctionsAmount === undefined\r\n        ? Number.POSITIVE_INFINITY\r\n        : options.nestedFunctionsAmount\r\n  };\r\n\r\n  return stringify(value, concreteOptions, {\r\n    references: [value],\r\n    nestedObjectsLeft: concreteOptions.nestedObjectsAmount as number,\r\n    nestedArraysLeft: concreteOptions.nestedArraysAmount as number,\r\n    nestedFunctionsLeft: concreteOptions.nestedFunctionsAmount as number\r\n  });\r\n}\r\n\r\nexport default javaScriptToString;\r\n"],"names":["getObjectType"],"mappings":"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"}