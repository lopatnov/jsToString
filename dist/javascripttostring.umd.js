(function (global, factory) {
    typeof exports === 'object' && typeof module !== 'undefined' ? module.exports = factory() :
    typeof define === 'function' && define.amd ? define(factory) :
    (global = typeof globalThis !== 'undefined' ? globalThis : global || self, global.javaScriptToString = factory());
})(this, (function () { 'use strict';

    function __spreadArray(e,t,r){if(r||2===arguments.length)for(var n,o=0,a=t.length;o<a;o++)!n&&o in t||(n||(n=Array.prototype.slice.call(t,0,o)),n[o]=t[o]);return e.concat(n||Array.prototype.slice.call(t))}"function"==typeof SuppressedError?SuppressedError:function(e,t,r){var n=new Error(r);return n.name="SuppressedError",n.error=e,n.suppressed=t,n};

    var types={},typesToString=types.toString,buildInList=["Boolean","Number","String","Function","Array","Date","RegExp","Object","Error","Promise","Generator","GeneratorFunction","ArrayBuffer","DataView"],typedArrays=["Int8Array","Uint8Array","Uint8ClampedArray","Int16Array","Uint16Array","Int32Array","Uint32Array","Float32Array","Float64Array","BigInt64Array","BigUint64Array"],maps=["Map","WeakMap"],sets=["Set","WeakSet"];function getInternalType(t){return null==t?t+"":"object"==typeof t||"function"==typeof t?types[typesToString.call(t)]||"object":typeof t}buildInList.forEach(function(t){types["[object "+t+"]"]=t.toLowerCase();}),maps.forEach(function(t){types["[object "+t+"]"]="map";}),sets.forEach(function(t){types["[object "+t+"]"]="set";}),typedArrays.forEach(function(t){types["[object "+t+"]"]="typedarray";});

    var refs=[],crossRefs=[],counter=0;function fillNativeFunctions(e,t,n,r){ void 0===r&&(r=true);for(var c=r?".prototype.":".",o=0,a=Object.getOwnPropertyNames(r?t.prototype:t);o<a.length;o++){var i=a[o];["caller","callee","arguments"].indexOf(i)<0&&(e["".concat(n).concat(c).concat(i)]=r?t.prototype[i]:t[i]);}}var nativeFunctions=function(){var e={};return fillNativeFunctions(e,Array,"Array",false),fillNativeFunctions(e,Array,"Array"),fillNativeFunctions(e,JSON,"JSON",false),fillNativeFunctions(e,Object,"Object",false),fillNativeFunctions(e,Object,"Object"),fillNativeFunctions(e,Function,"Function",false),fillNativeFunctions(e,Function,"Function"),fillNativeFunctions(e,Date,"Date",false),fillNativeFunctions(e,String,"String"),e.Function=Function,e}();function numberToString(e){if(Number.isNaN(e))return "Number.NaN";switch(e){case Number.POSITIVE_INFINITY:return "Number.POSITIVE_INFINITY";case Number.NEGATIVE_INFINITY:return "Number.NEGATIVE_INFINITY";case Number.EPSILON:return "Number.EPSILON";case Number.MAX_SAFE_INTEGER:return "Number.MAX_SAFE_INTEGER";case Number.MIN_SAFE_INTEGER:return "Number.MIN_SAFE_INTEGER";case Number.MAX_VALUE:return "Number.MAX_VALUE";case Number.MIN_VALUE:return "Number.MIN_VALUE";case Math.PI:return "Math.PI";case Math.E:return "Math.E";case Math.LN10:return "Math.LN10";case Math.LN2:return "Math.LN2";case Math.LOG10E:return "Math.LOG10E";case Math.LOG2E:return "Math.LOG2E";case Math.SQRT1_2:return "Math.SQRT1_2";case Math.SQRT2:return "Math.SQRT2";default:return String(e)}}function symbolToString(e){switch(e){case Symbol.asyncIterator:case Symbol.hasInstance:case Symbol.isConcatSpreadable:case Symbol.iterator:case Symbol.match:case Symbol.prototype:case Symbol.replace:case Symbol.search:case Symbol.species:case Symbol.split:case Symbol.toPrimitive:case Symbol.toStringTag:case Symbol.unscopables:return e.description;default:var t=e.description?'"'.concat(e.description,'"'):"";return "Symbol(".concat(t,")")}}function dateToString(e){return isNaN(e.getTime())?"new Date(".concat(e.toString(),")"):"new Date(".concat(e.toISOString(),")")}function errorToString(e){var t=JSON.stringify(e.message),n=JSON.stringify(e.fileName),r=JSON.stringify(e.lineNumber);return "new Error(".concat(t,", ").concat(n,", ").concat(r,")")}function arrayToString(e,t,n){if(0===e.length)return "[]";var r=e.reduce(function(e,r,c){var o=c.toString();n.references.push(o),n.currentPath.push(o);var a=e?"".concat(e,", "):"";return a+=stringifyRef(r,t,n),n.currentPath.pop(),n.references.pop(),a},"");return attachActions(getLocalRefs(e),"[".concat(r,"]"))}function getLocalRefs(e){return refs.filter(function(t){return t.source===e})}function attachActions(e,t){if(e.length>0){counter=counter++%Number.MAX_SAFE_INTEGER;var n="___j2s_".concat(counter),r=e.reduce(function(e,t){var r=converToAction(n,t);return refs.splice(refs.indexOf(t),1),e+r},"");return "(function(){ var ".concat(n," = ").concat(t,"; ").concat(r," return ").concat(n,"; }())")}return t}function converToAction(e,t){var n=t.historyRef.indexOf(t.source);if(n<0)return "";for(var r,c=t.historyRef.slice(n),o="",a=0;a<c.length;a++){var i=c[a];if(i===t.source)o=e,r=t.source;else if("string"==typeof i)o+="['".concat(i.replace(/'/gi,"\\'"),"']"),r=r[i];else if(i!==r)return ""}return "".concat(o," = ").concat(e,"; ")}function typedArrayToString(e,t,n){var r=arrayToString(Array.from(e),t,n),c=e.constructor.name;return "new ".concat(c,"(").concat(r,")")}function setToString(e,t,n){var r=[];return e.forEach(function(e,c,o){r.push(stringifyRef(c,t,n));}),0===r.length?"new Set()":"new Set([".concat(r.join(", "),"])")}function mapToString(e,t,n){var r=[];return e.forEach(function(e,c){r.push("[".concat(stringifyRef(c,t,n),", ").concat(stringifyRef(e,t,n),"]"));}),0===r.length?"new Map()":"new Map([".concat(r.join(", "),"])")}function objectToString(e,t,n){var r=[];for(var c in e)if(e.hasOwnProperty(c)){n.references.push(c),n.currentPath.push(c);var o=stringifyRef(e[c],t,n);n.currentPath.pop(),n.references.pop(),"undefined"!==o&&(/^[a-zA-Z]+$/.test(c)||(c='"'.concat(c,'"')),r.push("".concat(c,": ").concat(o)));}return 0===r.length?"{}":attachActions(getLocalRefs(e),"{\n".concat(r.join(",\n"),"\n}"))}function functionPropertiesToString(e,t,n,r){var c="";for(var o in t)if(t.hasOwnProperty(o)){r.references.push(o),r.currentPath.push(o);var a=stringifyRef(t[o],n,r);r.currentPath.pop(),r.references.pop(),"undefined"!==a&&(c+="".concat(e,".").concat(o," = ").concat(a,";\n"));}return c}function functionToString(e,t,n){var r=e.name||"anonymousFunction",c=t.includeFunctionProperties?functionPropertiesToString(r,e,t,n):"";n.references.push("prototype"),n.currentPath.push("prototype");var o=t.includeFunctionPrototype?functionPropertiesToString("".concat(r,".prototype"),e.prototype,t,n):"";n.currentPath.pop(),n.references.pop();var a=String(e);if(a.indexOf("[native code]")>-1&&a.length<100)for(var i in nativeFunctions)nativeFunctions[i]===e&&(a=i);return c||o?attachActions(getLocalRefs(e),"(function(){\n var ".concat(r," = ").concat(String(a),";\n ").concat(c,"\n ").concat(o,"\n return ").concat(r,";\n}())")):a}function arrayBufferToString(e,t,n){if(!t.includeBuffers)return "undefined";var r=typedArrayToString(new Int8Array(e),t,n);return "(".concat(r,").buffer")}function dataViewToString(e,t,n){if(!t.includeBuffers)return "undefined";var r=arrayBufferToString(e.buffer,t,n);return "new DataView(".concat(r,", ").concat(e.byteOffset,", ").concat(e.byteLength,")")}function stringify(e,t,n){switch(getInternalType(e)){case "undefined":case "promise":case "generator":return "undefined";case "null":return "null";case "boolean":case "regexp":return String(e);case "string":default:return JSON.stringify(e);case "number":return numberToString(e);case "bigint":return "BigInt(".concat(e,")");case "symbol":return symbolToString(e);case "date":return dateToString(e);case "error":return errorToString(e);case "array":return arrayToString(e,t,n);case "typedarray":return typedArrayToString(e,t,n);case "set":return setToString(e,t,n);case "map":return mapToString(e,t,n);case "object":return objectToString(e,t,n);case "function":case "generatorfunction":return functionToString(e,t,n);case "arraybuffer":return arrayBufferToString(e,t,n);case "dataview":return dataViewToString(e,t,n)}}function stringifyRef(e,t,n){var r="object"==typeof e&&null!==e||"function"==typeof e,c=n.references.indexOf(e);if(r&&n.visited.has(e)&&c<0)return crossRefs.push({destPath:__spreadArray([],n.currentPath,true),sourcePath:n.visited.get(e)||[]}),"null";if(c<0||"string"==typeof n.references[c]){var o=getInternalType(e),a=n.references.length;switch(r&&!n.visited.has(e)&&n.visited.set(e,__spreadArray([],n.currentPath,true)),n.references.push(e),o){case "object":if(n.nestedObjectsLeft<=0)return "undefined";n.nestedObjectsLeft--;break;case "array":case "typedarray":if(n.nestedArraysLeft<=0)return "undefined";n.nestedArraysLeft--;break;case "function":case "generatorfunction":if(n.nestedFunctionsLeft<=0)return "undefined";n.nestedFunctionsLeft--;}var i=stringify(e,t,n);switch(n.references.splice(a),o){case "object":n.nestedObjectsLeft++;break;case "array":case "typedarray":n.nestedArraysLeft++;break;case "function":case "generatorfunction":n.nestedFunctionsLeft++;}return i}return refs.push({historyRef:n.references.slice(0),source:e}),"null"}function attachCrossRefActions(e,t){if(0===e.length)return t;counter=counter++%Number.MAX_SAFE_INTEGER;var n="___j2s_".concat(counter),r=e.map(function(e){var t=e.destPath.map(function(e){return "['".concat(e.replace(/'/gi,"\\'"),"']")}).join(""),r=e.sourcePath.map(function(e){return "['".concat(e.replace(/'/gi,"\\'"),"']")}).join("");return "".concat(n).concat(t," = ").concat(n).concat(r,"; ")}).join("");return "(function(){ var ".concat(n," = ").concat(t,"; ").concat(r,"return ").concat(n,"; }())")}function javaScriptToString(e,t){var n={includeFunctionProperties:void 0===(t=t||{}).includeFunctionProperties||t.includeFunctionProperties,includeFunctionPrototype:void 0===t.includeFunctionPrototype||t.includeFunctionPrototype,includeBuffers:void 0===t.includeBuffers||t.includeBuffers,nestedObjectsAmount:void 0===t.nestedObjectsAmount?Number.POSITIVE_INFINITY:t.nestedObjectsAmount,nestedArraysAmount:void 0===t.nestedArraysAmount?Number.POSITIVE_INFINITY:t.nestedArraysAmount,nestedFunctionsAmount:void 0===t.nestedFunctionsAmount?Number.POSITIVE_INFINITY:t.nestedFunctionsAmount};refs=[],crossRefs=[],counter=0;var r=new Map;r.set(e,[]);var c=stringify(e,n,{references:[e],nestedObjectsLeft:n.nestedObjectsAmount,nestedArraysLeft:n.nestedArraysAmount,nestedFunctionsLeft:n.nestedFunctionsAmount,visited:r,currentPath:[]}),o=attachActions(getLocalRefs(e),c);return attachCrossRefActions(crossRefs,o)}

    return javaScriptToString;

}));
//# sourceMappingURL=javascripttostring.umd.js.map
